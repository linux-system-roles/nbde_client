---
- name: Initialize nbde_client_failed_binding and nbde_client_test_slot for device {{ nbde_client_selected_device }}
  set_fact:
    nbde_client_failed_binding: false
    nbde_client_test_slot: 0

- name: Keep binding until it fails
  include_tasks: bind_slot_with_passphrase.yml

- name: Display last used slot
  debug:
    msg: Last used slot was "{{ nbde_client_test_slot }}" for device "{{ nbde_client_selected_device }}"

- name: Verify the binding failed to be added at least once
  assert:
    that: nbde_client_failed_binding is true

# vim:set ts=2 sw=2 et:
